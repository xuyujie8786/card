# âœ… å‡†å¤‡å°±ç»ª - å¯ä»¥å¼€å§‹éƒ¨ç½²äº†ï¼

> **æ‰€æœ‰æ–‡ä»¶å·²å‡†å¤‡å®Œæ¯•ï¼Œå¯†ç å·²ç”Ÿæˆï¼Œè„šæœ¬å·²å°±ç»ªï¼**

---

## ğŸ“¦ å‡†å¤‡å®Œæˆæ¸…å•

### âœ… æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| `.env.production.new` | ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆåŒ…å«æ‰€æœ‰å¯†ç ï¼‰ | âœ… å·²ç”Ÿæˆ |
| `deploy-to-lightsail-complete.sh` | ä¸€é”®éƒ¨ç½²è„šæœ¬ | âœ… å¯æ‰§è¡Œ |
| `docker-compose.production.yml` | Dockerç¼–æ’é…ç½® | âœ… å·²ä¼˜åŒ– |
| `backend/Dockerfile.optimized` | åç«¯é•œåƒé…ç½® | âœ… å·²ä¼˜åŒ– |
| `v1/Dockerfile.optimized` | å‰ç«¯é•œåƒé…ç½® | âœ… å·²ä¼˜åŒ– |

### âœ… æ–‡æ¡£æ–‡ä»¶

| æ–‡ä»¶ | å†…å®¹ |
|------|------|
| `DEPLOYMENT_QUICKSTART.md` | 10åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨æŒ‡å— |
| `LIGHTSAIL_DEPLOYMENT_GUIDE.md` | è¯¦ç»†éƒ¨ç½²æ–‡æ¡£ï¼ˆå«æ•…éšœæ’é™¤ï¼‰ |
| `PASSWORDS.txt` | æ‰€æœ‰å¯†ç è®°å½•ï¼ˆè¯·å¦¥å–„ä¿ç®¡ï¼‰ |

---

## ğŸ” ç”Ÿæˆçš„å¯†ç ï¼ˆæ— ç‰¹æ®Šç¬¦å·ï¼‰

```
æ•°æ®åº“å¯†ç :   j4FcyddfkduL03q3FpT9yQO5blKoFC0b
Rediså¯†ç :    jZPqLlVMqwZeZ8lByXRBQZu4AYZlLJr4
ç®¡ç†å‘˜å¯†ç :   k7LjrKOcHsHFtOIZ
ç®¡ç†å‘˜é‚®ç®±:   admin@vcard.local
```

---

## ğŸš€ ç«‹å³å¼€å§‹éƒ¨ç½²

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºLightsailå®ä¾‹

1. è®¿é—®ï¼šhttps://lightsail.aws.amazon.com/
2. ç‚¹å‡»ã€Œåˆ›å»ºå®ä¾‹ã€
3. é€‰æ‹©é…ç½®ï¼š
   - **åŒºåŸŸ**: æ–°åŠ å¡ (ap-southeast-1)
   - **ç³»ç»Ÿ**: Ubuntu 22.04 LTS
   - **å¥—é¤**: $10/æœˆ (2GB RAM, 1 vCPU, 60GB SSD)
4. åˆ›å»ºé™æ€IPå¹¶ç»‘å®š
5. é…ç½®é˜²ç«å¢™ï¼šå¼€æ”¾ç«¯å£ 22, 8000, 3001
6. ä¸‹è½½SSHå¯†é’¥åˆ°ï¼š`~/.ssh/LightsailDefaultKey-ap-southeast-1.pem`

```bash
# è®¾ç½®å¯†é’¥æƒé™
chmod 400 ~/.ssh/LightsailDefaultKey-ap-southeast-1.pem
```

### ç¬¬äºŒæ­¥ï¼šä¸€é”®éƒ¨ç½²

```bash
# åœ¨ä½ çš„Macä¸Šæ‰§è¡Œ
cd ~/vcard

# æ›¿æ¢ä¸ºä½ çš„LightsailæœåŠ¡å™¨IP
./deploy-to-lightsail-complete.sh 52.74.58.160
```

**éƒ¨ç½²è¿‡ç¨‹çº¦10-15åˆ†é’Ÿï¼Œå®Œå…¨è‡ªåŠ¨åŒ–ï¼š**

- âœ… è‡ªåŠ¨ä¸Šä¼ ä»£ç 
- âœ… è‡ªåŠ¨å®‰è£…Docker
- âœ… è‡ªåŠ¨æ„å»ºé•œåƒ
- âœ… è‡ªåŠ¨å¯åŠ¨æœåŠ¡
- âœ… è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“
- âœ… è‡ªåŠ¨éªŒè¯éƒ¨ç½²

### ç¬¬ä¸‰æ­¥ï¼šè®¿é—®ç³»ç»Ÿ

```
æµè§ˆå™¨æ‰“å¼€: http://ä½ çš„æœåŠ¡å™¨IP:8000
ç™»å½•è´¦å·: admin@vcard.local
ç™»å½•å¯†ç : k7LjrKOcHsHFtOIZ
```

---

## ğŸ“‹ éƒ¨ç½²æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ›å»ºLightsailå®ä¾‹   â”‚
â”‚  (5åˆ†é’Ÿ)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸‹è½½SSHå¯†é’¥        â”‚
â”‚  è®¾ç½®æƒé™           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿è¡Œéƒ¨ç½²è„šæœ¬       â”‚
â”‚  (10-15åˆ†é’Ÿ)        â”‚
â”‚  å®Œå…¨è‡ªåŠ¨åŒ–         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®¿é—®ç³»ç»Ÿ           â”‚
â”‚  http://IP:8000     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å…³é”®ç‰¹æ€§

### ğŸ”’ å®‰å…¨æ€§

- âœ… æ‰€æœ‰å¯†ç è‡ªåŠ¨ç”Ÿæˆï¼ˆä»…å­—æ¯æ•°å­—ï¼Œæ— ç‰¹æ®Šç¬¦å·ï¼‰
- âœ… æ•°æ®åº“å’ŒRedisä»…å®¹å™¨å†…éƒ¨è®¿é—®
- âœ… JWTå¯†é’¥64ä½å¼ºåº¦
- âœ… æ”¯æŒåŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰

### âš¡ æ€§èƒ½ä¼˜åŒ–

- âœ… å¤šé˜¶æ®µDockeræ„å»ºï¼ˆé•œåƒä½“ç§¯å°ï¼‰
- âœ… Nginxé™æ€èµ„æºç¼“å­˜
- âœ… Redisç¼“å­˜åŠ é€Ÿ
- âœ… PostgreSQLè¿æ¥æ± ä¼˜åŒ–

### ğŸ› ï¸ è¿ç»´å‹å¥½

- âœ… å¥åº·æ£€æŸ¥è‡ªåŠ¨é‡å¯
- âœ… æ—¥å¿—è‡ªåŠ¨è½®è½¬
- âœ… ä¸€é”®éƒ¨ç½²å’Œæ›´æ–°
- âœ… å®Œæ•´çš„ç›‘æ§å’Œæ—¥å¿—

---

## ğŸ“± éƒ¨ç½²åæ“ä½œ

### 1. ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 

ç™»å½•åï¼š

1. ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ å®‰å…¨è®¾ç½®
2. ä¿®æ”¹å¯†ç 
3. å¯ç”¨2FAï¼ˆæ¨èï¼‰

### 2. é…ç½®é˜²ç«å¢™ï¼ˆå¯é€‰ï¼‰

```bash
ssh -i ~/.ssh/LightsailDefaultKey-ap-southeast-1.pem ubuntu@ä½ çš„IP

sudo apt-get install -y ufw
sudo ufw allow 22/tcp
sudo ufw allow 8000/tcp
sudo ufw allow 3001/tcp
sudo ufw enable
```

### 3. è®¾ç½®è‡ªåŠ¨å¤‡ä»½ï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > /home/ubuntu/backup.sh << 'BACKUP_SCRIPT'
#!/bin/bash
BACKUP_DIR="/home/ubuntu/backups"
mkdir -p $BACKUP_DIR
sudo docker exec vcard-postgres pg_dump -U vcard_user vcard_db > \
  $BACKUP_DIR/backup_$(date +%Y%m%d_%H%M%S).sql
find $BACKUP_DIR -name "backup_*.sql" -mtime +7 -delete
BACKUP_SCRIPT

chmod +x /home/ubuntu/backup.sh

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰
crontab -e
# æ·»åŠ ï¼š0 2 * * * /home/ubuntu/backup.sh
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: éƒ¨ç½²å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
ssh -i ~/.ssh/LightsailDefaultKey-ap-southeast-1.pem ubuntu@ä½ çš„IP
cd /home/ubuntu/vcard
sudo docker compose -f docker-compose.production.yml logs
```

### Q: å¿˜è®°ç®¡ç†å‘˜å¯†ç ï¼Ÿ

æŸ¥çœ‹å¯†ç è®°å½•æ–‡ä»¶ï¼š

```bash
cat ~/vcard/PASSWORDS.txt
```

### Q: å¦‚ä½•é‡æ–°éƒ¨ç½²ï¼Ÿ

```bash
# å†æ¬¡è¿è¡Œéƒ¨ç½²è„šæœ¬å³å¯
./deploy-to-lightsail-complete.sh ä½ çš„IP
```

### Q: å¦‚ä½•æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€ï¼Ÿ

```bash
ssh -i ~/.ssh/LightsailDefaultKey-ap-southeast-1.pem ubuntu@ä½ çš„IP
cd /home/ubuntu/vcard
sudo docker compose -f docker-compose.production.yml ps
```

---

## ğŸ“š æ›´å¤šæ–‡æ¡£

| æ–‡æ¡£ | å†…å®¹ |
|------|------|
| `DEPLOYMENT_QUICKSTART.md` | å¿«é€Ÿå¯åŠ¨æŒ‡å— |
| `LIGHTSAIL_DEPLOYMENT_GUIDE.md` | è¯¦ç»†éƒ¨ç½²æ–‡æ¡£ |
| `PASSWORDS.txt` | å¯†ç è®°å½• |
| `docker-compose.production.yml` | Dockeré…ç½®è¯´æ˜ |

---

## âš ï¸ é‡è¦æé†’

1. **è¯·å¦¥å–„ä¿ç®¡ `PASSWORDS.txt` æ–‡ä»¶**
2. **ä¸è¦å°† `.env.production.new` æäº¤åˆ°Git**
3. **é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹ç®¡ç†å‘˜å¯†ç **
4. **å»ºè®®å¯ç”¨HTTPSï¼ˆä½¿ç”¨Nginx + Let's Encryptï¼‰**
5. **å®šæœŸå¤‡ä»½æ•°æ®åº“**

---

## ğŸ‰ å‡†å¤‡å¥½äº†å—ï¼Ÿ

ç°åœ¨å°±åˆ›å»ºLightsailå®ä¾‹ï¼Œç„¶åè¿è¡Œï¼š

```bash
./deploy-to-lightsail-complete.sh <ä½ çš„æœåŠ¡å™¨IP>
```

**ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼** ğŸš€

---

*ç”Ÿæˆæ—¶é—´: 2025-10-02*  
*ç‰ˆæœ¬: v1.0.0*
